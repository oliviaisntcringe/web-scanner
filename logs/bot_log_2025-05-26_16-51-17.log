2025-05-26 16:51:17,740 - web_scanner_bot - INFO - ===== Веб сканнер с Telegram ботом запущен =====
2025-05-26 16:51:17,740 - web_scanner_bot - INFO - Логи сохраняются в: logs/bot_log_2025-05-26_16-51-17.log
2025-05-26 16:51:17,741 - web_scanner_bot - INFO - Telegram Bot Token: 78009...ZhopI
2025-05-26 16:51:17,744 - web_scanner_bot - INFO - Запуск Telegram бота
2025-05-26 16:51:17,744 - web_scanner_bot - INFO - Запуск в существующем event loop
2025-05-26 16:51:17,744 - web_scanner_bot - INFO - Бот запущен
2025-05-26 16:51:17,744 - web_scanner_bot - INFO - Инициализация приложения Telegram
2025-05-26 16:51:18,176 - web_scanner_bot - INFO - Регистрация обработчиков команд
2025-05-26 16:51:18,176 - web_scanner_bot - INFO - Запуск бота через run_polling
2025-05-26 16:51:18,177 - web_scanner_bot - ERROR - Критическая ошибка в run_bot_async: Cannot close a running event loop
2025-05-26 16:51:18,213 - web_scanner_bot - ERROR - Полная трассировка ошибки:
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/telegram/ext/_application.py", line 1042, in __run
    loop.run_until_complete(self._bootstrap_initialize(max_retries=bootstrap_retries))
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 695, in run_until_complete
    self._check_running()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 631, in _check_running
    raise RuntimeError('This event loop is already running')
RuntimeError: This event loop is already running

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/telegram/ext/_application.py", line 1067, in __run
    loop.run_until_complete(self.shutdown())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 695, in run_until_complete
    self._check_running()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 631, in _check_running
    raise RuntimeError('This event loop is already running')
RuntimeError: This event loop is already running

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/x/Desktop/веб сканнер /bot/bot.py", line 889, in run_bot_async
    await application.run_polling(allowed_updates=Update.ALL_TYPES)
          ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/telegram/ext/_application.py", line 832, in run_polling
    return self.__run(
           ~~~~~~~~~~^
        updater_coroutine=self.updater.start_polling(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<9 lines>...
        close_loop=close_loop,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/telegram/ext/_application.py", line 1072, in __run
    loop.close()
    ~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/unix_events.py", line 70, in close
    super().close()
    ~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/selector_events.py", line 101, in close
    raise RuntimeError("Cannot close a running event loop")
RuntimeError: Cannot close a running event loop

2025-05-26 16:51:18,214 - web_scanner_bot - CRITICAL - задача бота упала с ошибкой: Cannot close a running event loop
2025-05-26 16:51:18,218 - web_scanner_bot - CRITICAL - полный стек ошибки:
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/telegram/ext/_application.py", line 1042, in __run
    loop.run_until_complete(self._bootstrap_initialize(max_retries=bootstrap_retries))
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 695, in run_until_complete
    self._check_running()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 631, in _check_running
    raise RuntimeError('This event loop is already running')
RuntimeError: This event loop is already running

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/telegram/ext/_application.py", line 1067, in __run
    loop.run_until_complete(self.shutdown())
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 695, in run_until_complete
    self._check_running()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 631, in _check_running
    raise RuntimeError('This event loop is already running')
RuntimeError: This event loop is already running

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/x/Desktop/веб сканнер /bot/bot.py", line 919, in handle_task_exception
    task.result()
    ~~~~~~~~~~~^^
  File "/Users/x/Desktop/веб сканнер /bot/bot.py", line 889, in run_bot_async
    await application.run_polling(allowed_updates=Update.ALL_TYPES)
          ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/telegram/ext/_application.py", line 832, in run_polling
    return self.__run(
           ~~~~~~~~~~^
        updater_coroutine=self.updater.start_polling(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<9 lines>...
        close_loop=close_loop,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/telegram/ext/_application.py", line 1072, in __run
    loop.close()
    ~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/unix_events.py", line 70, in close
    super().close()
    ~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/selector_events.py", line 101, in close
    raise RuntimeError("Cannot close a running event loop")
RuntimeError: Cannot close a running event loop

